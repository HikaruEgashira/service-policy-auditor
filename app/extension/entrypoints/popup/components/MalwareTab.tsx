import type { CSPViolation, NetworkRequest } from "@service-policy-auditor/csp";
import { ViolationList } from "./ViolationList";
import { NetworkList } from "./NetworkList";
import { PolicyGenerator } from "./PolicyGenerator";
import { CSPSettings } from "./CSPSettings";
import { styles } from "../styles";

interface Props {
  violations: CSPViolation[];
  networkRequests: NetworkRequest[];
}

export function MalwareTab({ violations, networkRequests }: Props) {
  return (
    <div>
      {violations.length > 0 && (
        <div>
          <ViolationList violations={violations} />
        </div>
      )}

      {networkRequests.length > 0 && (
        <div style={{ borderTop: "1px solid hsl(0 0% 80%)", marginTop: "16px", paddingTop: "16px" }}>
          <NetworkList requests={networkRequests} />
        </div>
      )}

      {(violations.length > 0 || networkRequests.length > 0) && (
        <div style={{ borderTop: "1px solid hsl(0 0% 80%)", marginTop: "16px", paddingTop: "16px" }}>
          <PolicyGenerator violations={violations} />
        </div>
      )}

      <div style={{ borderTop: "1px solid hsl(0 0% 80%)", marginTop: "16px", paddingTop: "16px" }}>
        <CSPSettings />
      </div>
    </div>
  );
}
